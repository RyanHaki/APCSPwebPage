---
layout: post
permalink: /pong/
title: Pong
---

<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<style>
	canvas {
		display: block;
		position: absolute;
		margin: auto;
		top: 0;
		bottom: 120px;
		left: 0;
		right: 0;
		border: 8px double rgb(132, 0, 209);
	}
	</style>
</head>
<body style="background-image: repeating-conic-gradient(rgb(11, 141, 24) 10%, rgb(255, 77, 0) 20%);">

<script>
var WIDTH = 900,
    HEIGHT = 380,
    pi = Math.PI,
    UKey = 38,
    DKey = 40,
    WKey = 87,
    SKey = 83,
    canvas,
    ctx,
    bong,
    score = {
      donger: 0,
      dude: 0
    },
    updateScore = function() {
      if (holygrace.x - holygrace.side < 0) {
        score.dude++;
      } else if (holygrace.x + holygrace.side > WIDTH) {
        score.donger++;
      }
    },
    drawScore = function() {
      ctx.fillText("Donger: " + score.donger, WIDTH/2 - 100, 40);
      ctx.fillText("Dude: " + score.dude, WIDTH/2 + 50, 40);
    },
    reset = function() {
      donger.x = 0;
      donger.y = HEIGHT/2 - donger.height/2;

      dude.x = WIDTH - dude.width;
      dude.y = HEIGHT/2 - dude.height/2;

      holygrace.serve(Math.random() > 0.5 ? 1 : -1);
    },
    step = function() {
      update();
      draw();
      window.requestAnimationFrame(step);
    },
    update = function() {
      updateScore();
      donger.update();
      dude.update();
      holygrace.update();

      if (score.donger >= 10 || score.dude >= 10) {
        reset();
      }
    },
    draw = function() {
      ctx.clearRect(0, 0, WIDTH, HEIGHT);
      drawScore();
      donger.draw();
      dude.draw();
      holygrace.draw();
    };

var donger = {
  width: 20,
  height: 100,
  update: function() {
    if (bong[WKey]) this.y -= 7;
    if (bong[SKey]) this.y += 7;
    this.y = Math.max(Math.min(this.y, HEIGHT - this.height), 0);
  },
  draw: function() {
    ctx.fillRect(this.x, this.y, this.width, this.height);
  }
};

var dude = {
width: 20,
height: 100,
update: function() {
if (bong[UKey]) this.y -= 7;
if (bong[DKey]) this.y += 7;
this.y = Math.max(Math.min(this.y, HEIGHT - this.height), 0);
},
draw: function() {
ctx.fillRect(this.x, this.y, this.width, this.height);
}
};

var holygrace = {
side: 20,
x: WIDTH/2,
y: HEIGHT/2,
velocity: 8,
serve: function(side) {
this.velocity = side * 8;
this.y = HEIGHT/2;
},
update: function() {
this.x += this.velocity;
if (this.x - this.side < donger.x + donger.width &&
this.y >= donger.y && this.y <= donger.y + donger.height) {
this.velocity = -this.velocity;
} else if (this.x + this.side > dude.x &&
this.y >= dude.y && this.y <= dude.y + dude.height) {
this.velocity = -this.velocity;
}

if (this.y - this.side < 0 || this.y + this.side > HEIGHT) {
  this.velocity *= -1;
}

},
draw: function() {
ctx.beginPath();
ctx.arc(this.x, this.y, this.side, 0, 2*pi);
ctx.fill();
}
};

window.onload = function() {
canvas = document.createElement("canvas");
canvas.width = WIDTH;
canvas.height = HEIGHT;
document.body.appendChild(canvas);

ctx = canvas.getContext("2d");
ctx.fillStyle = "white";

bong = [];
document.addEventListener("keydown", function(e) {
bong[e.keyCode] = true;
});
document.addEventListener("keyup", function(e) {
bong[e.keyCode] = false;
});

reset();
step();
};

</script>
</body>
</html>